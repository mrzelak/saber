s' = [
      1627.0x^0 + 1197.0x^1 + 5617.0x^2 + 3638.0x^3
      1929.0x^0 + 7105.0x^1 + 2798.0x^2 + 4984.0x^3
     ]

A = [
     [
       1.0x^0 +  2.0x^1 +  3.0x^2 +  4.0x^3
       5.0x^0 +  6.0x^1 +  7.0x^2 +  8.0x^3
     ]
     [
       9.0x^0 + 10.0x^1 + 11.0x^2 + 12.0x^3
      13.0x^0 + 14.0x^1 + 15.0x^2 + 16.0x^3
     ]
    ]

A @ s' = [
          A[0, 0] * s'[0] + A[0, 1] * s'[1]
          A[1, 0] * s'[0] + A[1, 1] * s'[1]
         ]

tricki do wolframa:

Exact[(...)(...)]  == wymnóż wielomiany do postaci kanonicznej
Apart[(...)/(...)] == podziel wielomian by uzyskać resztę z dzielenia

no to jedziemy.

A[0,0]*s'[0] = (1x^0+2x^1+3x^2+4x^3)*(1627x^0+1197x^1+5617x^2+3638x^3) =
              1627+4451x+12892x^2+24971x^3+28915x^4+33382x^5+14552x^6 (%(x^4+1))
                                       -27288-28931x-1660x^2+24971x^3 (mod8192)
                                            5480+3837x+6532x^2+395x^3

A[0,1]*s'[1] = (5x^0+6x^1+7x^2+8x^3)*(1929x^0+7105x^1+2798x^2+4984x^3) =
           9645+47099x+70123x^2+106875x^3+106330x^4+57272x^5+39872x^6 (%(x^4+1))
                                     -96685-10173x+30251x^2+106875x^3 (mod8192)
                                            1619+6211x+5675x^2+379x^3

A[0,0]*s'[0]+A[0,1]*s'[1] =
                                    5480 + 3837 x + 6532 x^2 + 395 x^3
                                  + 1619 + 6211 x + 5675 x^2 + 379 x^3
                               _______________________________________
                                    7099 + 10048x + 12207x^2 + 774 x^3 (mod 8192)
                                    7099 + 1856 x + 4015 x^2 + 774 x^3
                                  +    4 +    4 x +    4 x^2 +   4 x^3 (h)
                                _______________________________________
                       TEST         7103 + 1860 x + 4019 x^2 + 778 x^3 (>> 3)
                       TEST          887 +  232 x +  502 x^2 +  97 x^3  

A[1,0]*s'[0] = (9x^0+10x^1+11x^2+12x^3)*(1627x^0+1197x^1+5617x^2+3638x^3) =
            14643+27043x+80420x^2+121603x^3+112531x^4+107422x^5+43656x^6 (%(x^4+1))
                                        -97888-80379x+36764x^2+121603x^3 (mod8192)
                                               416+1541x+3996x^2+6915x^3

A[1,1]*s'[1] = (13x^0+14x^1+15x^2+16x^3)*(1929x^0+7105x^1+2798x^2+4984x^3) =
           25077+119371x+164779x^2+241403x^3+225426x^4+119528x^5+79744x^6 (%(x^4+1))
                                          -200349-157x+85035x^2+241403x^3 (mod8192)
                                               4451+8035x+3115x^2+3835x^3

A[1,0]*s'[0]+A[1,1]*s'[1] =
                                     416 + 1541 x + 3996 x^2 + 6915 x^3
                                  + 4451 + 8035 x + 3115 x^2 + 3835 x^3
                                _______________________________________
                                    4867 + 9576 x + 7111 x^2 +10750 x^3 (mod8192)
                                    4867 + 1384 x + 7111 x^2 + 2558 x^3
                                  +    4 +    4 x +    4 x^2 +    4 x^3 (h)
                                _______________________________________
                       TEST         4871 + 1388 x + 7115 x^2 + 2562 x^3 (>> 3)
                       TEST          608 +  173 x +  889 x^2 +  320 x^3

b' mod q = [
            7103 + 1860 x + 4019 x^2 +  778 x^3
            4871 + 1388 x + 7115 x^2 + 2562 x^3
           ]

b' mod p = [
            887 + 232 x + 502 x^2 +  97 x^3  
            608 + 173 x + 889 x^2 + 320 x^3
           ]

disclaimer: b' mod p nie jest b' mod p. Jest to bardziej
cast z Rq do Rp, nie ma to zbyt wiele wspólnego z klasyczną
operacją mod.

s' mod p = [
            603x^0 + 173x^1 + 497x^2 + 566x^3
            905x^0 + 961x^1 + 750x^2 + 888x^3
           ]

disclaimer: s' mod p akurat jest dokładnie mod p. Siłą rzeczy to działa jak cast.

b mod p = [
           934x^0 + 997x^1 + 50x^2 + 140x^3
           890x^0 + 993x^1 + 88x^2 + 222x^3
          ]

v' = b . (s' mod p) = b[0] * (s'[0] mod p) + b[1] * (s'[1] mod p) 

b[0]*s'[0] mod p = (934x^0+997x^1+50x^2+140x^3)*(603x^0+173x^1+497x^2+566x^3) =
             563202+762773x+666829x^2+1117223x^3+613372x^4+97880x^5+79240x^6 (%(x^4+1))
                                         -50170+664893x+587589x^2+1117223x^3 (mod1024)
                                                         6+317x+837x^2+39x^3

b[1]*s'[1] mod p = (890x^0+993x^1+88x^2+222x^3)*(905x^0+961x^1+750x^2+888x^3) =
        805450+1753955x+1701413x^2+1820548x^3+1161126x^4+244644x^5+197136x^6 (%(x^4+1))
                                      -355676+1509311x+1504277x^2+1820548x^3 (mod1024)
                                                       676+959x+21x^2+900x^3

b[0]*(s'[0] mod p)+b[1]*(s'[1] mod p) =
                                    6 + 317 x + 837 x^2 +  39 x^3
                                + 676 + 959 x +  21 x^2 + 900 x^3
                                _________________________________
                                  682 +1276 x + 858 x^2 + 939 x^3 (mod 1024)
                       TEST       682 + 252 x + 858 x^2 + 939 x^3

v' = 682x^0+252x^1+858x^2+939x^3

m = [ 1 1 1 1 ]

m mod p = 512x^0+512x^1+512x^2+512x^3 TEST

pre_cm = v' - m mod p + h1
cm = pre_cm >> 7

                                  682 + 252 x + 858 x^2 + 939 x^3
                                - 512 - 512 x - 512 x^2 - 512 x^3     
                                _________________________________
                                  170 - 260 x + 346 x^2 + 427 x^3 (mod 1024)
                                  170 + 764 x + 346 x^2 + 427 x^3
                               +    4 +   4 x +   4 x^2 +   4 x^3 (h1)
                                _________________________________
                                  174 + 768 x + 350 x^2 + 431 x^3 (>> 7)
                       TEST         1 +   6 x +   2 x^2 +   3 x^3


DECIPHER

cm = cm << 7

                                    1 +   6 x +   2 x^2 +   3 x^3
                       TEST       128 + 768 x + 256 x^2 + 384 x^3


s mod p = [
           17x^0+18x^1+19x^2+20x^3
           21x^0+22x^1+23x^2+24x^3
          ]

b'[0]*(s[0] mod p) = (887+232x+502x^2+97x^3)*(17x^0+18x^1+19x^2+20x^3) =
             15079+19910x+29563x^2+32833x^3+15924x^4+11883x^5+1940x^6 (%(x^4+1))
                                         -845+8027x+27623x^2+32833x^3 (mod1024)
                                                179+859x+999x^2+65x^3 

b'[1]*(s[1] mod p) = (608+173x+889x^2+320x^3)*(21x^0+22x^1+23x^2+24x^3) =
              12768+17009x+36459x^2+44849x^3+31639x^4+28696x^5+7680x^6 (%(x^4+1))
                                       -18871-11687x+28779x^2+44849x^3 (mod1024)
                                                585+601x+107x^2+817x^3

b'[0]*(s[0] mod p) + b'[1]*(s[1] mod p) =
                                      179 + 859 x + 999 x^2 +  65 x^3 
                                    + 585 + 601 x + 107 x^2 + 817 x^3
                                    _________________________________
                                      764 +1460 x +1106 x^2 + 882 x^3 (mod 1024)
                                      764 + 436 x +  82 x^2 + 882 x^3

v = 764 + 436 x +  82 x^2 + 882 x^3

v - cm + h2

                                      764 + 436 x +  82 x^2 + 882 x^3
                                    - 128 - 768 x - 256 x^2 - 384 x^3
                                    _________________________________
                                      636 - 332 x - 174 x^2 + 498 x^3 (mod 1024)
                                      636 + 692 x + 850 x^2 + 498 x^3
                                    + 196 + 196 x + 196 x^2 + 196 x^3 (h2)
                                    _________________________________
                                      832 + 888 x +1046 x^2 + 694 x^3
                       TEST           832 + 888 x +  22 x^2 + 694 x^3

m' = 832 + 888 x + 22 x^2 + 694 x^3

m' >> 9

m = [ 1 1 0 1 ]
